<h3 class="text-center">Current notes</h3>
{{> notes_list}}

<h3 class="text-center">Add new note</h3>
<div id="addNoteFormContainer">
    <form role="form" id="addNoteForm">
        <div class="form-group">
            <label for="noteTitle">Note title</label>
            <input type="text" class="form-control" id="noteTitle" name="noteTitle">
        </div>
        <div class="form-group">
            <label for="noteDescription">Note description</label>
            <textarea class="form-control" id="noteDescription" rows="3" name="noteDescription"></textarea>
        </div>

        <div class="form-group">
            <div>
                <button type="submit" class="btn btn-primary">Save note</button>
            </div>
        </div>
    </form>
</div>

<script>
    document.getElementById('addNoteForm')
        .addEventListener('submit', event => {
            event.preventDefault();
            const form = event.target;
            const body = JSON.stringify({
                noteTitle: form.elements.noteTitle.value,
                noteDescription: form.elements.noteDescription.value,
            });
            const headers = { 'Content-Type': 'application/json' };
            const container = document.getElementById('addNoteFormContainer');
            fetch('/api/add-note', { method: 'post', body, headers })
                .then(resp => {
                    if(resp.status < 200 || resp.status >= 300)
                        throw new Error('Request failure');
                    return resp.json()
                })
                .then(json => {
                    container.innerHTML = 'Note added'
                })
                .catch(err => {
                    container.innerHTML = 'An error occurs'
                });
        });
</script>
